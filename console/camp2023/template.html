<!DOCTYPE html><html xml:lang="ja" lang="ja">
<head>
  <title>校庭キャンプ2023</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <!-- UML: PlantUML
    参考：JavaScriptを用いてPlantUMLを呼び出す
    https://168iroha.net/blog/topic/?id=202206081036&sorting=post_date
  -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js"></script>

  <!-- MarkDownテキストをHTML化するCDN -->
  <script src="https://taisukef.github.io/marked_md/marked.min.js"></script>

  <!-- TimeTable用CSS -->
  <style type="text/css" data-embed=""></style>
</head>
<body>
  <div><h1>スケジュール</h1>
    <div class="image"><div class="wrapPlantUML"><img class="PlantUML" name="schedule1"></img></div></div>
    <div class="markdown" name="schedule2"></div>
  </div>

  <div><h1>タイムテーブル</h1>
    <ul>
      <li>図中の「▼」「▶️」をクリックすると下位項目が開閉されます</li>
      <li>作業項目名をクリックすると詳細が表の下に表示されます</li>
    </ul>
    <div class="timetable" name="tt01" data-embed="">
    </div>
  </div>

  <div><h1>マップ</h1>
    <img width="60%" data-embed="" />
  </div>

  <div><h1>肝試し</h1>
    <img width="80%" data-embed="" />
    <div class="markdown" name="kimodameshi"></div>
  </div>

  <div><h1>関連サイト</h1>
    <div class="markdown" name="RelatedSites" data-embed=""></div>
  </div>

  <div><h1>参考：論議メモ</h1>
    <details><summary>2023/06/10 定例会</summary>
      <div class="markdown" name="20230610" data-embed=""></div>
    </details>
    <details><summary>2023/07/08 定例会</summary>
      <div class="markdown" name="20230708" data-embed=""></div>
    </details>
  </div>

<script data-embed="szLib.js"></script>

<script type="text/javascript" class="main">


// ブラウザ上で実行する場合の処理
window.addEventListener('DOMContentLoaded',() => {
  console.log('timetable test start.');
  const v = {};
  const url = {
    GAS:'https://script.google.com/macros/s/AKfycbwm3R0FbnhGALwO1J8G0yxNBvGAL6kPKewyypoz3OFIwIaB56D9XKAjkbopwpOEYdFm/exec',
    sheet: 'https://tinyurl.com/2ahyly3l',
  }
  fetch(url.GAS)
  .then(response => response.json()).then(r => {
    const v = {raw:r,docs:{}};

    // タイムテーブルの表示
    const tt01 = new TimeTable('div.timetable[name="tt01"]',v.raw,{datatype:'sheet',dataSheet:url.sheet});

    // docsのオブジェクト化
    for( v.i=1 ; v.i<v.raw.docs.length ; v.i++ ){
      v.l = v.raw.docs[v.i];
      if( !(v.l[1] in v.docs) ) v.docs[v.l[1]] = {};  // type不存在
      v.docs[v.l[1]][v.l[2]] = v.l[3];
    }
    console.log(v.docs);

    // MarkDownで記述された部分をHTML化して表示
    console.log(document.querySelectorAll('div.markdown'));
    document.querySelectorAll('div.markdown').forEach(x => {
      //console.log(v.docs.markdown[x.getAttribute('name')])
      x.innerHTML = marked(v.docs.markdown[x.getAttribute('name')]);
    });

    // PlantUMLで記述された部分をHTML化して表示
    document.querySelectorAll('img.PlantUML').forEach(x => {
      //console.log(v.docs.PlantUML[x.getAttribute('name')])
      x.src = "http://www.plantuml.com/plantuml/svg/"+plantumlEncoder.encode(v.docs.PlantUML[x.getAttribute('name')]);
    });
  });
});
</script>
</body></html>