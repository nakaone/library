<!DOCTYPE html><html xml:lang="ja" lang="ja"><head>
  <title>校庭キャンプ2023</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  
  <!-- UML: PlantUML
    参考：JavaScriptを用いてPlantUMLを呼び出す
    https://168iroha.net/blog/topic/?id=202206081036&sorting=post_date
  -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js"></script>

  <!-- MarkDownテキストをHTML化するCDN -->
  <script src="https://taisukef.github.io/marked_md/marked.min.js"></script>

  <style type="text/css">
    .img {
      width: 80%;
      overflow: scroll;
    }
  </style>
</head>
<body class="TabMenu" name="main">

  <div class="tabs"><!-- タグメニュー -->
    <div name="notice">notice</div>
    <div name="passport">passport</div>
    <div name="scanner">scanner</div>
    <div name="notes">notes</div>
    <div name="info">information</div>
  </div>

  <div name="notice"><h1>お知らせ</h1></div>
  <div name="passport"><h1>パスポート</h1></div><!-- 参加者/スタッフ択一 -->
  <div name="scanner"><h1>QRコード受付</h1></div><!-- 参加者/スタッフ択一 -->
  <div name="notes"><h1>注意事項</h1></div>
  <div name="info"><h1>お役立ち情報</h1>
    <div class="TabMenu" name="info">
      <div class="tabs">
        <div name="schedule">schedule</div>
        <div name="timetable">table</div>
        <div name="map">map</div>
        <div name="expedition">expedition</div>
        <div name="sites">sites</div>
        <div name="minutes">minutes</div>
        <div name="summary">summary</div>
      </div>

      <div name="schedule"><h2>スケジュール</h2>
        <div class="image"><div class="wrapPlantUML"><img class="PlantUML" name="schedule1"></img></div></div>
        <div class="markdown" name="schedule2"></div>
        <!--
          遊び場保険、スケジュールに追加
        -->
      </div>
    
      <div name="timetable"><h2>タイムテーブル</h2>
        <ul>
          <li>図中の「▼」「▶️」をクリックすると下位項目が開閉されます</li>
          <li>作業項目名をクリックすると詳細が表の下に表示されます</li>
        </ul>
        <div class="timetable" name="tt01">
        </div>
        <!--
          詳細は別ページ？　別ペイン？
          表示範囲絞り込み
          所要物一覧
        -->
      </div>
    
      <div name="map"><h2>校内全体図</h2>
        <div class="img" data-embed="map2023.svg"></div>
      </div>

      <div name="expedition"><h2>肝試しルート</h2>
        <img width="600px" data-embed='{"from":{"filename":"expedition.txt"},"to":"png"}' />
      </div>

      <div name="sites"><h2>関連サイト</h2>
        <div class="markdown" name="RelatedSites" data-embed="RelatedSites.md"></div>
      </div>
    
      <div name="minutes"><h2>論議メモ</h2>
        <div class="TabMenu" name="minutes">
          <div class="tabs">
            <div name="20230610">6/10定例会</div>
            <div name="20230708">7/08定例会</div>
          </div>
          <div class="markdown" name="20230610" data-embed="20230610.md"></div>
          <div class="markdown" name="20230708" data-embed="20230708.md"></div>
        </div>
      </div>

      <div name="summary"><h2>参加者数集計</h2>
        <div name="test" class="mermaid">
          sequenceDiagram
            太郎->>花子: おはよう
            花子->>太郎: こんにちは！！
        </div>
      </div>
    </div>
  </div>


<script src="https://cdn.jsdelivr.net/npm/mermaid@10.2.4/dist/mermaid.min.js"></script>

<!-- 自作ライブラリ -->
<script type="text/javascript" data-embed='{"from":{"filename":"../../component/mergeDeeply.html","selector":"script.core"},"to":"js"}'></script>
<script type="text/javascript" data-embed='{"from":{"filename":"../../component/TabMenu.html","selector":"script.core"},"to":"js"}'></script>
<script type="text/javascript" class="main">
// ブラウザ上で実行する場合の処理
window.addEventListener('DOMContentLoaded',() => {
  const v = {};
  // メニューを定義
  document.querySelectorAll('.TabMenu[name]').forEach(x => {
    v.menuName = x.getAttribute('name');
    v.arg = {name:v.menuName};
    console.log(v.menuName,v.arg);
    v[v.menuName] = new TabMenu(v.arg);
  });
  //v.main = new TabMenu({name:"main"});
  //v.map = new TabMenu({name:"info"});

  // Google Spreadからデータを取得してタイムテーブル表示
  const url = {
    GAS:'https://script.google.com/macros/s/AKfycbwm3R0FbnhGALwO1J8G0yxNBvGAL6kPKewyypoz3OFIwIaB56D9XKAjkbopwpOEYdFm/exec',
    sheet: 'https://tinyurl.com/2ahyly3l',
  }
  fetch(url.GAS)
  .then(response => response.json()).then(r => {
    // タイムテーブルの表示
    const tt01 = new TimeTable('div.timetable[name="tt01"]',v.raw,{datatype:'sheet',dataSheet:url.sheet});

  });

    // MarkDownで記述された部分をHTML化して表示
    document.querySelectorAll('div.markdown').forEach(x => {
      x.innerHTML = marked(x.innerHTML);
    });

    // PlantUMLで記述された部分をHTML化して表示
    document.querySelectorAll('img.PlantUML').forEach(x => {
      x.src = "http://www.plantuml.com/plantuml/svg/"
        + plantumlEncoder.encode(x.innerHTML);
    });

    // Mermaidで記述された部分をHTML化して表示
    mermaid.initialize({startOnLoad: true});
});
</script>
</body></html>