<script type="text/javascript">
/** 新規申込処理、または受付番号未登録時の登録処理
 * @param {HTMLElement} dom - クリックされたボタン
 * @returns {void}
 */
function enterIdentifyKey(dom){
  const v = {whois:'enterIdentifyKey',rv:null,step:0};
  console.log(`${v.whois} start.`);
  try {

    v.key = dom.parentNode.querySelector('input').value;
    if( dom.parentNode.getAttribute('name') === 'enterMail' ){
      // メールアドレス入力
    } else {
      // 受付番号入力
      if( v.key.match(/^[0-9]+/) ){
        v.step = 1;
        v.r = g.authMenu.storeUserInfo(Number(v.key));
        if( v.r instanceof Error ) throw v.r;

        v.step = 2; // メニュー再描画
        v.r = g.authMenu.genNavi();
        if( v.r instanceof Error ) throw v.r;

        v.step = 3; // ホーム画面に遷移
        v.r = g.authMenu.changeScreen();
        if( v.r instanceof Error ) throw v.r;

      } else {
        v.step = 4;
        alert('受付番号は数値で指定してください');
      }
    }

    v.step = 9; // 終了処理
    console.log(`${v.whois} normal end.`);

  } catch(e) {
    e.message = `${v.whois} abnormal end at step.${v.step}\n${e.message}`;
    console.error(`${e.message}\nv=${stringify(v)}`);
    alert(e.message);
  }
}
</script>
<div name="enterMail">
  <p>新規に応募される方、または受付番号がわからなくなった方は、以下にメールアドレスを入力してください。</p>
  <input type="email" size="40" /><button onclick="enterIdentifyKey(this)">送信</button>
</div>
<div name="enterUserId">
  <p>受付番号をご存じの方は、以下に受付番号を入力してください。</p>
  <input type="number" /><button onclick="enterIdentifyKey(this)">送信</button>
</div>