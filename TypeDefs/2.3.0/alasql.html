<!DOCTYPE html><html xml:lang="ja" lang="ja"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<style type="text/css"></style>
<script src="https://cdn.jsdelivr.net/npm/alasql@4.4.0/dist/alasql.min.js"></script>
</head>
<body>
</body>
<script>
function htmlEscape(str){ // https://jp-seemore.com/web/3534/#toc5
  return typeof str !== 'string' ? str : str
    .replaceAll(/&/g, "&amp;")
    .replaceAll(/</g, "&lt;")
    .replaceAll(/>/g, "&gt;")
    .replaceAll(/"/g, "&quot;")
    .replaceAll(/'/g, "&#039;");
}
const v={data:{"arg":{"sh":"master","nId":"id","lv":"l([0-9]+)","base":"base","note":null,"attr":{"dataType":"string","role":"string"},"header":1,"data":[2,null]},"header":["l1","l2","l3","l4","l5","l6","l7","l8","id","base","dataType","role","note"],"obj":{"0":{"nId":0},"1":{"nId":1,"level":1,"label":"authMenu","pId":0,"seq":1,"num":0,"base":null,"row":2,"raw":{"l1":"authMenu","id":1,"dataType":"project"},"stRow":3,"edRow":107},"2":{"nId":2,"level":2,"label":"DocumentProperties","pId":1,"seq":1,"num":22,"base":null,"row":3,"raw":{"l2":"DocumentProperties","id":2,"dataType":"DocumentProperties"},"stRow":4,"edRow":28},"3":{"nId":3,"level":3,"label":"ログイン認証関係","pId":2,"seq":1,"num":0,"base":null,"row":4,"raw":{"l3":"ログイン認証関係","id":3},"edRow":4},"4":{"nId":4,"level":3,"label":"passcodeDigits","pId":2,"seq":2,"num":0,"base":null,"row":5,"raw":{"l3":"passcodeDigits","id":4,"dataType":"{number}=6","role":"パスコードの桁数"},"edRow":5},"5":{"nId":5,"level":3,"label":"loginRetryInterval","pId":2,"seq":3,"num":0,"base":null,"row":6,"raw":{"l3":"loginRetryInterval","id":5,"dataType":"{number}=3600000","role":"前回ログイン失敗(凍結)から再挑戦可能になるまでの時間(ミリ秒)"},"edRow":6},"6":{"nId":6,"level":3,"label":"numberOfLoginAttempts","pId":2,"seq":4,"num":0,"base":null,"row":7,"raw":{"l3":"numberOfLoginAttempts","id":6,"dataType":"{number}=3","role":"ログイン失敗になるまでの試行回数"},"edRow":7},"7":{"nId":7,"level":3,"label":"loginGraceTime","pId":2,"seq":5,"num":0,"base":null,"row":8,"raw":{"l3":"loginGraceTime","id":7,"dataType":"{number}=900000","role":"パスコード生成からログインまでの猶予時間(ミリ秒)"},"edRow":8},"8":{"nId":8,"level":3,"label":"notificatePasscodeMail","pId":2,"seq":6,"num":3,"base":null,"row":9,"raw":{"l3":"notificatePasscodeMail","id":8,"dataType":"{Object}","role":"パスコード連絡メールのテンプレート"},"stRow":10,"edRow":12},"9":{"nId":9,"level":4,"label":"subject","pId":8,"seq":1,"num":0,"base":null,"row":10,"raw":{"l4":"subject","id":9,"dataType":"{string}='[連絡] パスコード'"},"edRow":10},"10":{"nId":10,"level":4,"label":"body","pId":8,"seq":2,"num":0,"base":null,"row":11,"raw":{"l4":"body","id":10,"dataType":"{string}='パスコードは以下の通りです。\\n\\n::passcode::'"},"edRow":11},"11":{"nId":11,"level":4,"label":"options","pId":8,"seq":3,"num":0,"base":null,"row":12,"raw":{"l4":"options","id":11,"dataType":"{Object}={}"},"edRow":12},"12":{"nId":12,"level":3,"label":"ユーザ情報関係","pId":2,"seq":7,"num":0,"base":null,"row":13,"raw":{"l3":"ユーザ情報関係","id":12},"edRow":13},"13":{"nId":13,"level":3,"label":"userLoginLifeTime","pId":2,"seq":8,"num":0,"base":null,"row":14,"raw":{"l3":"userLoginLifeTime","id":13,"dataType":"{number}=86400000","role":"クライアント側ログイン(CPkey)有効期間"},"edRow":14},"14":{"nId":14,"level":3,"label":"defaultAuth","pId":2,"seq":9,"num":0,"base":null,"row":15,"raw":{"l3":"defaultAuth","id":14,"dataType":"{number}=2","role":"新規登録者に設定する権限"},"edRow":15},"15":{"nId":15,"level":3,"label":"userIdStartNumber","pId":2,"seq":10,"num":0,"base":null,"row":16,"raw":{"l3":"userIdStartNumber","id":15,"dataType":"{number}=1","role":"ユーザID(数値)の開始値"},"edRow":16},"16":{"nId":16,"level":3,"label":"シート定義関係","pId":2,"seq":11,"num":0,"base":null,"row":17,"raw":{"l3":"シート定義関係","id":16},"edRow":17},"17":{"nId":17,"level":3,"label":"masterSheet","pId":2,"seq":12,"num":0,"base":null,"row":18,"raw":{"l3":"masterSheet","id":17,"dataType":"{string}='master'","role":"参加者マスタのシート名"},"edRow":18},"18":{"nId":18,"level":3,"label":"primatyKeyColumn","pId":2,"seq":13,"num":0,"base":null,"row":19,"raw":{"l3":"primatyKeyColumn","id":18,"dataType":"{string}='userId'","role":"主キーとなる項目名。主キー項目の値は数値で設定"},"edRow":19},"19":{"nId":19,"level":3,"label":"emailColumn","pId":2,"seq":14,"num":0,"base":null,"row":20,"raw":{"l3":"emailColumn","id":19,"dataType":"{string}='email'","role":"e-mailを格納するシート上の項目名"},"edRow":20},"20":{"nId":20,"level":3,"label":"サーバ側RSAキー関連情報","pId":2,"seq":15,"num":0,"base":null,"row":21,"raw":{"l3":"サーバ側RSAキー関連情報","id":20},"edRow":21},"21":{"nId":21,"level":3,"label":"passPhrase","pId":2,"seq":16,"num":0,"base":null,"row":22,"raw":{"l3":"passPhrase","id":21,"dataType":"{string}=null","role":"パスフレーズ"},"edRow":22},"22":{"nId":22,"level":3,"label":"passPhraseLength","pId":2,"seq":17,"num":0,"base":null,"row":23,"raw":{"l3":"passPhraseLength","id":22,"dataType":"{number}=16","role":"authServerのパスフレーズの長さ"},"edRow":23},"23":{"nId":23,"level":3,"label":"bits","pId":2,"seq":18,"num":0,"base":null,"row":24,"raw":{"l3":"bits","id":23,"dataType":"{number}=1024","role":"RSAキーのビット長"},"edRow":24},"24":{"nId":24,"level":3,"label":"passPhrase","pId":2,"seq":19,"num":0,"base":null,"row":25,"raw":{"l3":"passPhrase","id":24,"dataType":"{string}","role":"サーバ側RSA鍵のパスフレーズ"},"edRow":25},"25":{"nId":25,"level":3,"label":"SPkey","pId":2,"seq":20,"num":0,"base":null,"row":26,"raw":{"l3":"SPkey","id":25,"dataType":"{string}","role":"サーバ側公開鍵"},"edRow":26},"26":{"nId":26,"level":3,"label":"authServerメソッド関係","pId":2,"seq":21,"num":0,"base":null,"row":27,"raw":{"l3":"authServerメソッド関係","id":26},"edRow":27},"27":{"nId":27,"level":3,"label":"allow","pId":2,"seq":22,"num":0,"base":null,"row":28,"raw":{"l3":"allow","id":27,"dataType":"{Object.<string,number>}","role":"authServerのメソッド実行に必要な権限"},"edRow":28},"28":{"nId":28,"level":2,"label":"sheet \"master\"","pId":1,"seq":2,"num":7,"base":null,"row":29,"raw":{"l2":"sheet \"master\"","id":28,"dataType":"Sheet"},"stRow":30,"edRow":36},"29":{"nId":29,"level":3,"label":"userId","pId":28,"seq":1,"num":0,"base":null,"row":30,"raw":{"l3":"userId","id":29},"edRow":30},"30":{"nId":30,"level":3,"label":"created","pId":28,"seq":2,"num":0,"base":null,"row":31,"raw":{"l3":"created","id":30},"edRow":31},"31":{"nId":31,"level":3,"label":"email","pId":28,"seq":3,"num":0,"base":null,"row":32,"raw":{"l3":"email","id":31},"edRow":32},"32":{"nId":32,"level":3,"label":"auth","pId":28,"seq":4,"num":0,"base":null,"row":33,"raw":{"l3":"auth","id":32},"edRow":33},"33":{"nId":33,"level":3,"label":"CPkey","pId":28,"seq":5,"num":0,"base":null,"row":34,"raw":{"l3":"CPkey","id":33},"edRow":34},"34":{"nId":34,"level":3,"label":"updated","pId":28,"seq":6,"num":0,"base":null,"row":35,"raw":{"l3":"updated","id":34},"edRow":35},"35":{"nId":35,"level":3,"label":"trial","pId":28,"seq":7,"num":0,"base":null,"row":36,"raw":{"l3":"trial","id":35},"edRow":36},"36":{"nId":36,"level":2,"label":"localStorage","pId":1,"seq":3,"num":1,"base":null,"row":37,"raw":{"l2":"localStorage","id":36,"dataType":"localStorage"},"stRow":38,"edRow":38},"37":{"nId":37,"level":3,"label":"userId","pId":36,"seq":1,"num":0,"base":null,"row":38,"raw":{"l3":"userId","id":37},"edRow":38},"38":{"nId":38,"level":2,"label":"sessionStorage","pId":1,"seq":4,"num":1,"base":null,"row":39,"raw":{"l2":"sessionStorage","id":38,"dataType":"sessionStorage"},"stRow":40,"edRow":41},"39":{"nId":39,"level":3,"label":"user","pId":38,"seq":1,"num":0,"base":"2,28","row":40,"raw":{"l3":"user","id":39,"base":"2,28","note":"【継承テスト用】"},"stRow":41,"edRow":41},"40":{"nId":40,"level":4,"label":"trial","pId":39,"seq":1,"num":0,"base":-35,"row":41,"raw":{"l4":"trial","id":40,"base":-35},"edRow":41},"41":{"nId":41,"level":2,"label":"index.html","pId":1,"seq":5,"num":1,"base":null,"row":42,"raw":{"l2":"index.html","id":41,"dataType":"Apps Script"},"stRow":43,"edRow":90},"42":{"nId":42,"level":3,"label":"authClient","pId":41,"seq":1,"num":0,"base":null,"row":43,"raw":{"l3":"authClient","id":42,"dataType":"{class}","role":"authMenuクライアント側の処理をまとめたクラス","note":"旧authMenu"},"stRow":44,"edRow":90},"43":{"nId":43,"level":4,"label":"メンバ変数","pId":42,"seq":1,"num":16,"base":null,"row":44,"raw":{"l4":"メンバ変数","id":43},"stRow":45,"edRow":62},"44":{"nId":44,"level":5,"label":"wrapper","pId":43,"seq":1,"num":0,"base":null,"row":45,"raw":{"l5":"wrapper","id":44,"dataType":"{HTMLElement}='.authMenu[name=\"wrapper\"]'","role":"メニュー全体を囲む要素。body不可"},"edRow":45},"45":{"nId":45,"level":5,"label":"icon","pId":43,"seq":2,"num":0,"base":null,"row":46,"raw":{"l5":"icon","id":45,"dataType":"{HTMLElement}","role":"メニューアイコンとなるHTML要素"},"edRow":46},"46":{"nId":46,"level":5,"label":"navi","pId":43,"seq":3,"num":0,"base":null,"row":47,"raw":{"l5":"navi","id":46,"dataType":"{HTMLElement}","role":"ナビ領域となるHTML要素"},"edRow":47},"47":{"nId":47,"level":5,"label":"back","pId":43,"seq":4,"num":0,"base":null,"row":48,"raw":{"l5":"back","id":47,"dataType":"{HTMLElement}","role":"ナビ領域の背景となるHTML要素"},"edRow":48},"48":{"nId":48,"level":5,"label":"userIdSelector","pId":43,"seq":5,"num":0,"base":null,"row":49,"raw":{"l5":"userIdSelector","id":48},"edRow":49},"49":{"nId":49,"level":5,"label":"publicAuth","pId":43,"seq":6,"num":0,"base":null,"row":50,"raw":{"l5":"publicAuth","id":49},"edRow":50},"50":{"nId":50,"level":5,"label":"memberAuth","pId":43,"seq":7,"num":0,"base":null,"row":51,"raw":{"l5":"memberAuth","id":50},"edRow":51},"51":{"nId":51,"level":5,"label":"allow","pId":43,"seq":8,"num":0,"base":null,"row":52,"raw":{"l5":"allow","id":51},"edRow":52},"52":{"nId":52,"level":5,"label":"func","pId":43,"seq":9,"num":0,"base":null,"row":53,"raw":{"l5":"func","id":52},"edRow":53},"53":{"nId":53,"level":5,"label":"home","pId":43,"seq":10,"num":0,"base":null,"row":54,"raw":{"l5":"home","id":53},"edRow":54},"54":{"nId":54,"level":5,"label":"initialSubMenu","pId":43,"seq":11,"num":0,"base":null,"row":55,"raw":{"l5":"initialSubMenu","id":54},"edRow":55},"55":{"nId":55,"level":5,"label":"css","pId":43,"seq":12,"num":0,"base":null,"row":56,"raw":{"l5":"css","id":55},"edRow":56},"56":{"nId":56,"level":5,"label":"RSAkeyLength","pId":43,"seq":13,"num":0,"base":null,"row":57,"raw":{"l5":"RSAkeyLength","id":56},"edRow":57},"57":{"nId":57,"level":5,"label":"passPhraseLength","pId":43,"seq":14,"num":0,"base":null,"row":58,"raw":{"l5":"passPhraseLength","id":57},"edRow":58},"58":{"nId":58,"level":5,"label":"user","pId":43,"seq":15,"num":2,"base":null,"row":59,"raw":{"l5":"user","id":58},"stRow":60,"edRow":61},"59":{"nId":59,"level":6,"label":"userId","pId":58,"seq":1,"num":0,"base":null,"row":60,"raw":{"l6":"userId","id":59,"role":"ユーザID"},"edRow":60},"60":{"nId":60,"level":6,"label":"auth","pId":58,"seq":2,"num":0,"base":null,"row":61,"raw":{"l6":"auth","id":60,"role":"ユーザ(クライアント)の権限"},"edRow":61},"61":{"nId":61,"level":5,"label":"screenAttr","pId":43,"seq":16,"num":0,"base":null,"row":62,"raw":{"l5":"screenAttr","id":61},"edRow":62},"62":{"nId":62,"level":4,"label":"constructor()","pId":42,"seq":2,"num":2,"base":null,"row":63,"raw":{"l4":"constructor()","id":62,"dataType":"{method}"},"stRow":64,"edRow":65},"63":{"nId":63,"level":5,"label":"引数","pId":62,"seq":1,"num":0,"base":null,"row":64,"raw":{"l5":"引数","id":63},"edRow":64},"64":{"nId":64,"level":5,"label":"戻り値","pId":62,"seq":2,"num":0,"base":null,"row":65,"raw":{"l5":"戻り値","id":64},"edRow":65},"65":{"nId":65,"level":4,"label":"changeScreen()","pId":42,"seq":3,"num":2,"base":null,"row":66,"raw":{"l4":"changeScreen()","id":65,"dataType":"{method}","role":"適宜認証を行った上で画面を切り替える"},"stRow":67,"edRow":68},"66":{"nId":66,"level":5,"label":"引数","pId":65,"seq":1,"num":0,"base":null,"row":67,"raw":{"l5":"引数","id":66},"edRow":67},"67":{"nId":67,"level":5,"label":"戻り値","pId":65,"seq":2,"num":0,"base":null,"row":68,"raw":{"l5":"戻り値","id":67},"edRow":68},"68":{"nId":68,"level":4,"label":"genNavi()","pId":42,"seq":4,"num":2,"base":null,"row":69,"raw":{"l4":"genNavi()","id":68,"dataType":"{method}","role":"親要素を走査してナビゲーションを作成"},"stRow":70,"edRow":71},"69":{"nId":69,"level":5,"label":"引数","pId":68,"seq":1,"num":0,"base":null,"row":70,"raw":{"l5":"引数","id":69},"edRow":70},"70":{"nId":70,"level":5,"label":"戻り値","pId":68,"seq":2,"num":0,"base":null,"row":71,"raw":{"l5":"戻り値","id":70},"edRow":71},"71":{"nId":71,"level":4,"label":"objectize()","pId":42,"seq":5,"num":2,"base":null,"row":72,"raw":{"l4":"objectize()","id":71,"dataType":"{method}","role":"data-menu属性の文字列をオブジェクトに変換"},"stRow":73,"edRow":74},"72":{"nId":72,"level":5,"label":"引数","pId":71,"seq":1,"num":0,"base":null,"row":73,"raw":{"l5":"引数","id":72},"edRow":73},"73":{"nId":73,"level":5,"label":"戻り値","pId":71,"seq":2,"num":0,"base":null,"row":74,"raw":{"l5":"戻り値","id":73},"edRow":74},"74":{"nId":74,"level":4,"label":"setProperties()","pId":42,"seq":6,"num":2,"base":null,"row":75,"raw":{"l4":"setProperties()","id":74,"dataType":"{method}","role":"constructorの引数と既定値からthisの値を設定"},"stRow":76,"edRow":78},"75":{"nId":75,"level":5,"label":"引数","pId":74,"seq":1,"num":0,"base":63,"row":76,"raw":{"l5":"引数","id":75,"base":63,"role":"constructorに渡された引数オブジェクト"},"edRow":76},"77":{"nId":77,"level":5,"label":"戻り値","pId":74,"seq":2,"num":0,"base":null,"row":78,"raw":{"l5":"戻り値","id":77,"dataType":"{null}"},"edRow":78},"78":{"nId":78,"level":4,"label":"storeUserInto()","pId":42,"seq":7,"num":2,"base":null,"row":79,"raw":{"l4":"storeUserInto()","id":78,"dataType":"{method}","role":"インスタンス変数やstorageに保存したユーザ情報を更新"},"stRow":80,"edRow":81},"79":{"nId":79,"level":5,"label":"引数","pId":78,"seq":1,"num":0,"base":null,"row":80,"raw":{"l5":"引数","id":79},"edRow":80},"80":{"nId":80,"level":5,"label":"戻り値","pId":78,"seq":2,"num":0,"base":null,"row":81,"raw":{"l5":"戻り値","id":80},"edRow":81},"81":{"nId":81,"level":4,"label":"doGAS()","pId":42,"seq":8,"num":2,"base":null,"row":82,"raw":{"l4":"doGAS()","id":81,"dataType":"{method}","role":"authMenu用の既定値をセットしてdoGASを呼び出し"},"stRow":83,"edRow":84},"82":{"nId":82,"level":5,"label":"引数","pId":81,"seq":1,"num":0,"base":null,"row":83,"raw":{"l5":"引数","id":82},"edRow":83},"83":{"nId":83,"level":5,"label":"戻り値","pId":81,"seq":2,"num":0,"base":null,"row":84,"raw":{"l5":"戻り値","id":83},"edRow":84},"84":{"nId":84,"level":4,"label":"toggle()","pId":42,"seq":9,"num":2,"base":null,"row":85,"raw":{"l4":"toggle()","id":84,"dataType":"{method}","role":"ナビゲーション領域の表示/非表示切り替え"},"stRow":86,"edRow":87},"85":{"nId":85,"level":5,"label":"引数","pId":84,"seq":1,"num":0,"base":null,"row":86,"raw":{"l5":"引数","id":85},"edRow":86},"86":{"nId":86,"level":5,"label":"戻り値","pId":84,"seq":2,"num":0,"base":null,"row":87,"raw":{"l5":"戻り値","id":86},"edRow":87},"87":{"nId":87,"level":4,"label":"showChildren()","pId":42,"seq":10,"num":0,"base":null,"row":88,"raw":{"l4":"showChildren()","id":87,"dataType":"{method}","role":"ブランチの下位階層メニュー表示/非表示切り替え"},"stRow":89,"edRow":90},"88":{"nId":88,"level":5,"label":"引数","pId":87,"seq":1,"num":0,"base":null,"row":89,"raw":{"l5":"引数","id":88},"edRow":89},"89":{"nId":89,"level":5,"label":"戻り値","pId":87,"seq":2,"num":0,"base":null,"row":90,"raw":{"l5":"戻り値","id":89},"edRow":90},"90":{"nId":90,"level":2,"label":"server.gs","pId":1,"seq":6,"num":2,"base":null,"row":91,"raw":{"l2":"server.gs","id":90,"dataType":"Apps Script","role":"authMenuサーバ側の処理"},"stRow":92,"edRow":99},"91":{"nId":91,"level":3,"label":"authFront","pId":90,"seq":1,"num":0,"base":null,"row":92,"raw":{"l3":"authFront","id":91,"dataType":"{function}","role":"authMenuサーバ側のフロント。適宜authServerのメソッドを呼び出す"},"edRow":92},"92":{"nId":92,"level":3,"label":"authServer","pId":90,"seq":2,"num":0,"base":null,"row":93,"raw":{"l3":"authServer","id":92,"dataType":"{class}","role":"authMenuサーバ側の処理をまとめたクラス"},"stRow":94,"edRow":99},"93":{"nId":93,"level":4,"label":"メンバ変数","pId":92,"seq":1,"num":1,"base":null,"row":94,"raw":{"l4":"メンバ変数","id":93},"stRow":95,"edRow":95},"94":{"nId":94,"level":5,"label":"prop","pId":93,"seq":1,"num":0,"base":3,"row":95,"raw":{"l5":"prop","id":94,"base":3,"dataType":"{Object}","role":"DocumentPropertiesのサーバ側設定値"},"edRow":95},"95":{"nId":95,"level":4,"label":"constructor()","pId":92,"seq":2,"num":0,"base":null,"row":96,"raw":{"l4":"constructor()","id":95,"dataType":"{method}","role":"事前準備。シートからユーザ情報全権取得、引数のオブジェクト化","note":"旧preProcess"},"edRow":96},"96":{"nId":96,"level":4,"label":"getUserInfo()","pId":92,"seq":3,"num":0,"base":null,"row":97,"raw":{"l4":"getUserInfo()","id":96,"dataType":"{method}","role":"authClientからの要求を受け、ユーザ情報と状態を返す"},"edRow":97},"97":{"nId":97,"level":4,"label":"sendPasscode()","pId":92,"seq":4,"num":0,"base":null,"row":98,"raw":{"l4":"sendPasscode()","id":97,"dataType":"{method}","role":"指定ユーザにパスコード連絡メールを発信する"},"edRow":98},"98":{"nId":98,"level":4,"label":"verifyPasscode()","pId":92,"seq":5,"num":0,"base":null,"row":99,"raw":{"l4":"verifyPasscode()","id":98,"dataType":"{method}","role":"入力されたパスコードの検証"},"edRow":99},"101":{"nId":101,"level":2,"label":"setProperties.gs","pId":1,"seq":7,"num":0,"base":null,"row":102,"raw":{"l2":"setProperties.gs","id":101,"dataType":"Apps Script","role":"authMenuサーバ側の設定値をDocumentPropertiesに設定"},"stRow":103,"edRow":107},"102":{"nId":102,"level":3,"label":"setProperties()","pId":101,"seq":1,"num":0,"base":null,"row":103,"raw":{"l3":"setProperties()","id":102,"dataType":"{function}"},"stRow":104,"edRow":107},"103":{"nId":103,"level":4,"label":"引数","pId":102,"seq":1,"num":0,"base":null,"row":104,"raw":{"l4":"引数","id":103},"edRow":104},"104":{"nId":104,"level":4,"label":"更新","pId":102,"seq":2,"num":1,"base":null,"row":105,"raw":{"l4":"更新","id":104},"stRow":106,"edRow":106},"105":{"nId":105,"level":5,"label":"DocumentProperties","pId":104,"seq":1,"num":0,"base":2,"row":106,"raw":{"l5":"DocumentProperties","id":105,"base":2},"edRow":106},"106":{"nId":106,"level":4,"label":"戻り値","pId":102,"seq":3,"num":0,"base":null,"row":107,"raw":{"l4":"戻り値","id":106},"edRow":107}},"arr":[{"nId":1,"level":1,"label":"authMenu","pId":0,"seq":1,"num":0,"base":null,"row":2,"raw":{"l1":"authMenu","id":1,"dataType":"project"},"stRow":3,"edRow":107},{"nId":2,"level":2,"label":"DocumentProperties","pId":1,"seq":1,"num":22,"base":null,"row":3,"raw":{"l2":"DocumentProperties","id":2,"dataType":"DocumentProperties"},"stRow":4,"edRow":28},{"nId":3,"level":3,"label":"ログイン認証関係","pId":2,"seq":1,"num":0,"base":null,"row":4,"raw":{"l3":"ログイン認証関係","id":3},"edRow":4},{"nId":4,"level":3,"label":"passcodeDigits","pId":2,"seq":2,"num":0,"base":null,"row":5,"raw":{"l3":"passcodeDigits","id":4,"dataType":"{number}=6","role":"パスコードの桁数"},"edRow":5},{"nId":5,"level":3,"label":"loginRetryInterval","pId":2,"seq":3,"num":0,"base":null,"row":6,"raw":{"l3":"loginRetryInterval","id":5,"dataType":"{number}=3600000","role":"前回ログイン失敗(凍結)から再挑戦可能になるまでの時間(ミリ秒)"},"edRow":6},{"nId":6,"level":3,"label":"numberOfLoginAttempts","pId":2,"seq":4,"num":0,"base":null,"row":7,"raw":{"l3":"numberOfLoginAttempts","id":6,"dataType":"{number}=3","role":"ログイン失敗になるまでの試行回数"},"edRow":7},{"nId":7,"level":3,"label":"loginGraceTime","pId":2,"seq":5,"num":0,"base":null,"row":8,"raw":{"l3":"loginGraceTime","id":7,"dataType":"{number}=900000","role":"パスコード生成からログインまでの猶予時間(ミリ秒)"},"edRow":8},{"nId":8,"level":3,"label":"notificatePasscodeMail","pId":2,"seq":6,"num":3,"base":null,"row":9,"raw":{"l3":"notificatePasscodeMail","id":8,"dataType":"{Object}","role":"パスコード連絡メールのテンプレート"},"stRow":10,"edRow":12},{"nId":9,"level":4,"label":"subject","pId":8,"seq":1,"num":0,"base":null,"row":10,"raw":{"l4":"subject","id":9,"dataType":"{string}='[連絡] パスコード'"},"edRow":10},{"nId":10,"level":4,"label":"body","pId":8,"seq":2,"num":0,"base":null,"row":11,"raw":{"l4":"body","id":10,"dataType":"{string}='パスコードは以下の通りです。\\n\\n::passcode::'"},"edRow":11},{"nId":11,"level":4,"label":"options","pId":8,"seq":3,"num":0,"base":null,"row":12,"raw":{"l4":"options","id":11,"dataType":"{Object}={}"},"edRow":12},{"nId":12,"level":3,"label":"ユーザ情報関係","pId":2,"seq":7,"num":0,"base":null,"row":13,"raw":{"l3":"ユーザ情報関係","id":12},"edRow":13},{"nId":13,"level":3,"label":"userLoginLifeTime","pId":2,"seq":8,"num":0,"base":null,"row":14,"raw":{"l3":"userLoginLifeTime","id":13,"dataType":"{number}=86400000","role":"クライアント側ログイン(CPkey)有効期間"},"edRow":14},{"nId":14,"level":3,"label":"defaultAuth","pId":2,"seq":9,"num":0,"base":null,"row":15,"raw":{"l3":"defaultAuth","id":14,"dataType":"{number}=2","role":"新規登録者に設定する権限"},"edRow":15},{"nId":15,"level":3,"label":"userIdStartNumber","pId":2,"seq":10,"num":0,"base":null,"row":16,"raw":{"l3":"userIdStartNumber","id":15,"dataType":"{number}=1","role":"ユーザID(数値)の開始値"},"edRow":16},{"nId":16,"level":3,"label":"シート定義関係","pId":2,"seq":11,"num":0,"base":null,"row":17,"raw":{"l3":"シート定義関係","id":16},"edRow":17},{"nId":17,"level":3,"label":"masterSheet","pId":2,"seq":12,"num":0,"base":null,"row":18,"raw":{"l3":"masterSheet","id":17,"dataType":"{string}='master'","role":"参加者マスタのシート名"},"edRow":18},{"nId":18,"level":3,"label":"primatyKeyColumn","pId":2,"seq":13,"num":0,"base":null,"row":19,"raw":{"l3":"primatyKeyColumn","id":18,"dataType":"{string}='userId'","role":"主キーとなる項目名。主キー項目の値は数値で設定"},"edRow":19},{"nId":19,"level":3,"label":"emailColumn","pId":2,"seq":14,"num":0,"base":null,"row":20,"raw":{"l3":"emailColumn","id":19,"dataType":"{string}='email'","role":"e-mailを格納するシート上の項目名"},"edRow":20},{"nId":20,"level":3,"label":"サーバ側RSAキー関連情報","pId":2,"seq":15,"num":0,"base":null,"row":21,"raw":{"l3":"サーバ側RSAキー関連情報","id":20},"edRow":21},{"nId":21,"level":3,"label":"passPhrase","pId":2,"seq":16,"num":0,"base":null,"row":22,"raw":{"l3":"passPhrase","id":21,"dataType":"{string}=null","role":"パスフレーズ"},"edRow":22},{"nId":22,"level":3,"label":"passPhraseLength","pId":2,"seq":17,"num":0,"base":null,"row":23,"raw":{"l3":"passPhraseLength","id":22,"dataType":"{number}=16","role":"authServerのパスフレーズの長さ"},"edRow":23},{"nId":23,"level":3,"label":"bits","pId":2,"seq":18,"num":0,"base":null,"row":24,"raw":{"l3":"bits","id":23,"dataType":"{number}=1024","role":"RSAキーのビット長"},"edRow":24},{"nId":24,"level":3,"label":"passPhrase","pId":2,"seq":19,"num":0,"base":null,"row":25,"raw":{"l3":"passPhrase","id":24,"dataType":"{string}","role":"サーバ側RSA鍵のパスフレーズ"},"edRow":25},{"nId":25,"level":3,"label":"SPkey","pId":2,"seq":20,"num":0,"base":null,"row":26,"raw":{"l3":"SPkey","id":25,"dataType":"{string}","role":"サーバ側公開鍵"},"edRow":26},{"nId":26,"level":3,"label":"authServerメソッド関係","pId":2,"seq":21,"num":0,"base":null,"row":27,"raw":{"l3":"authServerメソッド関係","id":26},"edRow":27},{"nId":27,"level":3,"label":"allow","pId":2,"seq":22,"num":0,"base":null,"row":28,"raw":{"l3":"allow","id":27,"dataType":"{Object.<string,number>}","role":"authServerのメソッド実行に必要な権限"},"edRow":28},{"nId":28,"level":2,"label":"sheet \"master\"","pId":1,"seq":2,"num":7,"base":null,"row":29,"raw":{"l2":"sheet \"master\"","id":28,"dataType":"Sheet"},"stRow":30,"edRow":36},{"nId":29,"level":3,"label":"userId","pId":28,"seq":1,"num":0,"base":null,"row":30,"raw":{"l3":"userId","id":29},"edRow":30},{"nId":30,"level":3,"label":"created","pId":28,"seq":2,"num":0,"base":null,"row":31,"raw":{"l3":"created","id":30},"edRow":31},{"nId":31,"level":3,"label":"email","pId":28,"seq":3,"num":0,"base":null,"row":32,"raw":{"l3":"email","id":31},"edRow":32},{"nId":32,"level":3,"label":"auth","pId":28,"seq":4,"num":0,"base":null,"row":33,"raw":{"l3":"auth","id":32},"edRow":33},{"nId":33,"level":3,"label":"CPkey","pId":28,"seq":5,"num":0,"base":null,"row":34,"raw":{"l3":"CPkey","id":33},"edRow":34},{"nId":34,"level":3,"label":"updated","pId":28,"seq":6,"num":0,"base":null,"row":35,"raw":{"l3":"updated","id":34},"edRow":35},{"nId":35,"level":3,"label":"trial","pId":28,"seq":7,"num":0,"base":null,"row":36,"raw":{"l3":"trial","id":35},"edRow":36},{"nId":36,"level":2,"label":"localStorage","pId":1,"seq":3,"num":1,"base":null,"row":37,"raw":{"l2":"localStorage","id":36,"dataType":"localStorage"},"stRow":38,"edRow":38},{"nId":37,"level":3,"label":"userId","pId":36,"seq":1,"num":0,"base":null,"row":38,"raw":{"l3":"userId","id":37},"edRow":38},{"nId":38,"level":2,"label":"sessionStorage","pId":1,"seq":4,"num":1,"base":null,"row":39,"raw":{"l2":"sessionStorage","id":38,"dataType":"sessionStorage"},"stRow":40,"edRow":41},{"nId":39,"level":3,"label":"user","pId":38,"seq":1,"num":0,"base":"2,28","row":40,"raw":{"l3":"user","id":39,"base":"2,28","note":"【継承テスト用】"},"stRow":41,"edRow":41},{"nId":40,"level":4,"label":"trial","pId":39,"seq":1,"num":0,"base":-35,"row":41,"raw":{"l4":"trial","id":40,"base":-35},"edRow":41},{"nId":41,"level":2,"label":"index.html","pId":1,"seq":5,"num":1,"base":null,"row":42,"raw":{"l2":"index.html","id":41,"dataType":"Apps Script"},"stRow":43,"edRow":90},{"nId":42,"level":3,"label":"authClient","pId":41,"seq":1,"num":0,"base":null,"row":43,"raw":{"l3":"authClient","id":42,"dataType":"{class}","role":"authMenuクライアント側の処理をまとめたクラス","note":"旧authMenu"},"stRow":44,"edRow":90},{"nId":43,"level":4,"label":"メンバ変数","pId":42,"seq":1,"num":16,"base":null,"row":44,"raw":{"l4":"メンバ変数","id":43},"stRow":45,"edRow":62},{"nId":44,"level":5,"label":"wrapper","pId":43,"seq":1,"num":0,"base":null,"row":45,"raw":{"l5":"wrapper","id":44,"dataType":"{HTMLElement}='.authMenu[name=\"wrapper\"]'","role":"メニュー全体を囲む要素。body不可"},"edRow":45},{"nId":45,"level":5,"label":"icon","pId":43,"seq":2,"num":0,"base":null,"row":46,"raw":{"l5":"icon","id":45,"dataType":"{HTMLElement}","role":"メニューアイコンとなるHTML要素"},"edRow":46},{"nId":46,"level":5,"label":"navi","pId":43,"seq":3,"num":0,"base":null,"row":47,"raw":{"l5":"navi","id":46,"dataType":"{HTMLElement}","role":"ナビ領域となるHTML要素"},"edRow":47},{"nId":47,"level":5,"label":"back","pId":43,"seq":4,"num":0,"base":null,"row":48,"raw":{"l5":"back","id":47,"dataType":"{HTMLElement}","role":"ナビ領域の背景となるHTML要素"},"edRow":48},{"nId":48,"level":5,"label":"userIdSelector","pId":43,"seq":5,"num":0,"base":null,"row":49,"raw":{"l5":"userIdSelector","id":48},"edRow":49},{"nId":49,"level":5,"label":"publicAuth","pId":43,"seq":6,"num":0,"base":null,"row":50,"raw":{"l5":"publicAuth","id":49},"edRow":50},{"nId":50,"level":5,"label":"memberAuth","pId":43,"seq":7,"num":0,"base":null,"row":51,"raw":{"l5":"memberAuth","id":50},"edRow":51},{"nId":51,"level":5,"label":"allow","pId":43,"seq":8,"num":0,"base":null,"row":52,"raw":{"l5":"allow","id":51},"edRow":52},{"nId":52,"level":5,"label":"func","pId":43,"seq":9,"num":0,"base":null,"row":53,"raw":{"l5":"func","id":52},"edRow":53},{"nId":53,"level":5,"label":"home","pId":43,"seq":10,"num":0,"base":null,"row":54,"raw":{"l5":"home","id":53},"edRow":54},{"nId":54,"level":5,"label":"initialSubMenu","pId":43,"seq":11,"num":0,"base":null,"row":55,"raw":{"l5":"initialSubMenu","id":54},"edRow":55},{"nId":55,"level":5,"label":"css","pId":43,"seq":12,"num":0,"base":null,"row":56,"raw":{"l5":"css","id":55},"edRow":56},{"nId":56,"level":5,"label":"RSAkeyLength","pId":43,"seq":13,"num":0,"base":null,"row":57,"raw":{"l5":"RSAkeyLength","id":56},"edRow":57},{"nId":57,"level":5,"label":"passPhraseLength","pId":43,"seq":14,"num":0,"base":null,"row":58,"raw":{"l5":"passPhraseLength","id":57},"edRow":58},{"nId":58,"level":5,"label":"user","pId":43,"seq":15,"num":2,"base":null,"row":59,"raw":{"l5":"user","id":58},"stRow":60,"edRow":61},{"nId":59,"level":6,"label":"userId","pId":58,"seq":1,"num":0,"base":null,"row":60,"raw":{"l6":"userId","id":59,"role":"ユーザID"},"edRow":60},{"nId":60,"level":6,"label":"auth","pId":58,"seq":2,"num":0,"base":null,"row":61,"raw":{"l6":"auth","id":60,"role":"ユーザ(クライアント)の権限"},"edRow":61},{"nId":61,"level":5,"label":"screenAttr","pId":43,"seq":16,"num":0,"base":null,"row":62,"raw":{"l5":"screenAttr","id":61},"edRow":62},{"nId":62,"level":4,"label":"constructor()","pId":42,"seq":2,"num":2,"base":null,"row":63,"raw":{"l4":"constructor()","id":62,"dataType":"{method}"},"stRow":64,"edRow":65},{"nId":63,"level":5,"label":"引数","pId":62,"seq":1,"num":0,"base":null,"row":64,"raw":{"l5":"引数","id":63},"edRow":64},{"nId":64,"level":5,"label":"戻り値","pId":62,"seq":2,"num":0,"base":null,"row":65,"raw":{"l5":"戻り値","id":64},"edRow":65},{"nId":65,"level":4,"label":"changeScreen()","pId":42,"seq":3,"num":2,"base":null,"row":66,"raw":{"l4":"changeScreen()","id":65,"dataType":"{method}","role":"適宜認証を行った上で画面を切り替える"},"stRow":67,"edRow":68},{"nId":66,"level":5,"label":"引数","pId":65,"seq":1,"num":0,"base":null,"row":67,"raw":{"l5":"引数","id":66},"edRow":67},{"nId":67,"level":5,"label":"戻り値","pId":65,"seq":2,"num":0,"base":null,"row":68,"raw":{"l5":"戻り値","id":67},"edRow":68},{"nId":68,"level":4,"label":"genNavi()","pId":42,"seq":4,"num":2,"base":null,"row":69,"raw":{"l4":"genNavi()","id":68,"dataType":"{method}","role":"親要素を走査してナビゲーションを作成"},"stRow":70,"edRow":71},{"nId":69,"level":5,"label":"引数","pId":68,"seq":1,"num":0,"base":null,"row":70,"raw":{"l5":"引数","id":69},"edRow":70},{"nId":70,"level":5,"label":"戻り値","pId":68,"seq":2,"num":0,"base":null,"row":71,"raw":{"l5":"戻り値","id":70},"edRow":71},{"nId":71,"level":4,"label":"objectize()","pId":42,"seq":5,"num":2,"base":null,"row":72,"raw":{"l4":"objectize()","id":71,"dataType":"{method}","role":"data-menu属性の文字列をオブジェクトに変換"},"stRow":73,"edRow":74},{"nId":72,"level":5,"label":"引数","pId":71,"seq":1,"num":0,"base":null,"row":73,"raw":{"l5":"引数","id":72},"edRow":73},{"nId":73,"level":5,"label":"戻り値","pId":71,"seq":2,"num":0,"base":null,"row":74,"raw":{"l5":"戻り値","id":73},"edRow":74},{"nId":74,"level":4,"label":"setProperties()","pId":42,"seq":6,"num":2,"base":null,"row":75,"raw":{"l4":"setProperties()","id":74,"dataType":"{method}","role":"constructorの引数と既定値からthisの値を設定"},"stRow":76,"edRow":78},{"nId":75,"level":5,"label":"引数","pId":74,"seq":1,"num":0,"base":63,"row":76,"raw":{"l5":"引数","id":75,"base":63,"role":"constructorに渡された引数オブジェクト"},"edRow":76},{"nId":77,"level":5,"label":"戻り値","pId":74,"seq":2,"num":0,"base":null,"row":78,"raw":{"l5":"戻り値","id":77,"dataType":"{null}"},"edRow":78},{"nId":78,"level":4,"label":"storeUserInto()","pId":42,"seq":7,"num":2,"base":null,"row":79,"raw":{"l4":"storeUserInto()","id":78,"dataType":"{method}","role":"インスタンス変数やstorageに保存したユーザ情報を更新"},"stRow":80,"edRow":81},{"nId":79,"level":5,"label":"引数","pId":78,"seq":1,"num":0,"base":null,"row":80,"raw":{"l5":"引数","id":79},"edRow":80},{"nId":80,"level":5,"label":"戻り値","pId":78,"seq":2,"num":0,"base":null,"row":81,"raw":{"l5":"戻り値","id":80},"edRow":81},{"nId":81,"level":4,"label":"doGAS()","pId":42,"seq":8,"num":2,"base":null,"row":82,"raw":{"l4":"doGAS()","id":81,"dataType":"{method}","role":"authMenu用の既定値をセットしてdoGASを呼び出し"},"stRow":83,"edRow":84},{"nId":82,"level":5,"label":"引数","pId":81,"seq":1,"num":0,"base":null,"row":83,"raw":{"l5":"引数","id":82},"edRow":83},{"nId":83,"level":5,"label":"戻り値","pId":81,"seq":2,"num":0,"base":null,"row":84,"raw":{"l5":"戻り値","id":83},"edRow":84},{"nId":84,"level":4,"label":"toggle()","pId":42,"seq":9,"num":2,"base":null,"row":85,"raw":{"l4":"toggle()","id":84,"dataType":"{method}","role":"ナビゲーション領域の表示/非表示切り替え"},"stRow":86,"edRow":87},{"nId":85,"level":5,"label":"引数","pId":84,"seq":1,"num":0,"base":null,"row":86,"raw":{"l5":"引数","id":85},"edRow":86},{"nId":86,"level":5,"label":"戻り値","pId":84,"seq":2,"num":0,"base":null,"row":87,"raw":{"l5":"戻り値","id":86},"edRow":87},{"nId":87,"level":4,"label":"showChildren()","pId":42,"seq":10,"num":0,"base":null,"row":88,"raw":{"l4":"showChildren()","id":87,"dataType":"{method}","role":"ブランチの下位階層メニュー表示/非表示切り替え"},"stRow":89,"edRow":90},{"nId":88,"level":5,"label":"引数","pId":87,"seq":1,"num":0,"base":null,"row":89,"raw":{"l5":"引数","id":88},"edRow":89},{"nId":89,"level":5,"label":"戻り値","pId":87,"seq":2,"num":0,"base":null,"row":90,"raw":{"l5":"戻り値","id":89},"edRow":90},{"nId":90,"level":2,"label":"server.gs","pId":1,"seq":6,"num":2,"base":null,"row":91,"raw":{"l2":"server.gs","id":90,"dataType":"Apps Script","role":"authMenuサーバ側の処理"},"stRow":92,"edRow":99},{"nId":91,"level":3,"label":"authFront","pId":90,"seq":1,"num":0,"base":null,"row":92,"raw":{"l3":"authFront","id":91,"dataType":"{function}","role":"authMenuサーバ側のフロント。適宜authServerのメソッドを呼び出す"},"edRow":92},{"nId":92,"level":3,"label":"authServer","pId":90,"seq":2,"num":0,"base":null,"row":93,"raw":{"l3":"authServer","id":92,"dataType":"{class}","role":"authMenuサーバ側の処理をまとめたクラス"},"stRow":94,"edRow":99},{"nId":93,"level":4,"label":"メンバ変数","pId":92,"seq":1,"num":1,"base":null,"row":94,"raw":{"l4":"メンバ変数","id":93},"stRow":95,"edRow":95},{"nId":94,"level":5,"label":"prop","pId":93,"seq":1,"num":0,"base":3,"row":95,"raw":{"l5":"prop","id":94,"base":3,"dataType":"{Object}","role":"DocumentPropertiesのサーバ側設定値"},"edRow":95},{"nId":95,"level":4,"label":"constructor()","pId":92,"seq":2,"num":0,"base":null,"row":96,"raw":{"l4":"constructor()","id":95,"dataType":"{method}","role":"事前準備。シートからユーザ情報全権取得、引数のオブジェクト化","note":"旧preProcess"},"edRow":96},{"nId":96,"level":4,"label":"getUserInfo()","pId":92,"seq":3,"num":0,"base":null,"row":97,"raw":{"l4":"getUserInfo()","id":96,"dataType":"{method}","role":"authClientからの要求を受け、ユーザ情報と状態を返す"},"edRow":97},{"nId":97,"level":4,"label":"sendPasscode()","pId":92,"seq":4,"num":0,"base":null,"row":98,"raw":{"l4":"sendPasscode()","id":97,"dataType":"{method}","role":"指定ユーザにパスコード連絡メールを発信する"},"edRow":98},{"nId":98,"level":4,"label":"verifyPasscode()","pId":92,"seq":5,"num":0,"base":null,"row":99,"raw":{"l4":"verifyPasscode()","id":98,"dataType":"{method}","role":"入力されたパスコードの検証"},"edRow":99},{"nId":101,"level":2,"label":"setProperties.gs","pId":1,"seq":7,"num":0,"base":null,"row":102,"raw":{"l2":"setProperties.gs","id":101,"dataType":"Apps Script","role":"authMenuサーバ側の設定値をDocumentPropertiesに設定"},"stRow":103,"edRow":107},{"nId":102,"level":3,"label":"setProperties()","pId":101,"seq":1,"num":0,"base":null,"row":103,"raw":{"l3":"setProperties()","id":102,"dataType":"{function}"},"stRow":104,"edRow":107},{"nId":103,"level":4,"label":"引数","pId":102,"seq":1,"num":0,"base":null,"row":104,"raw":{"l4":"引数","id":103},"edRow":104},{"nId":104,"level":4,"label":"更新","pId":102,"seq":2,"num":1,"base":null,"row":105,"raw":{"l4":"更新","id":104},"stRow":106,"edRow":106},{"nId":105,"level":5,"label":"DocumentProperties","pId":104,"seq":1,"num":0,"base":2,"row":106,"raw":{"l5":"DocumentProperties","id":105,"base":2},"edRow":106},{"nId":106,"level":4,"label":"戻り値","pId":102,"seq":3,"num":0,"base":null,"row":107,"raw":{"l4":"戻り値","id":106},"edRow":107}]}};
v.systemCols = {
  nId: 'int primary key',// {number} ノードのID。自然数
  level: 'int',// {number} 当該行の階層。自然数
  label: 'string',// {string} ノードのラベル
  note: 'string',// {string} 備考欄
  pId: 'int',// {number} 親ノードのID
  seq: 'int',// {number} 親ノード内での順番。自然数
  num: 'int default 0',// {number} 子要素の数
  base: 'string',// {string} 継承元ノード(基底ノード)のID。カンマ区切りで多重継承に対応
  row: 'int',// {number} シート上の行番号(自然数)
  // ----- 以下はTypeDefClient内で追加される項目 -------------------
  isOpen: 'boolean default false',  // {boolean} html表示時、trueなら子要素を表示
  path: 'string', // {string} ルート〜自要素までのnId。カンマ区切り
  lId: 'int default "-1"', // 継承によってシステム内で追加された要素の引用元のnId
};
v.cols = Object.assign({},v.systemCols);//,this.raw.arg.attr);
v.sql = '';
Object.keys(v.cols).forEach(col => v.sql += `\`${col}\` ${v.cols[col]},`);
v.sql = `create table node (${v.sql.slice(0,v.sql.length-1)})`;
v.r = alasql(v.sql);

for( v.i=0 ; v.i<v.data.arr.length ; v.i++ ){
  v.o = v.data.arr[v.i];
  v.cols = []; v.vals = [];
  Object.keys(v.systemCols).forEach(x => {
    if( v.o[x] || v.o[x] === 0 ){
      v.cols.push('`'+x+'`');
      v.vals.push(v.systemCols[x].match(/string/)
      ? `"${htmlEscape(v.o[x])}"` : v.o[x]);
    }
  });
  v.sql = `insert into node (${v.cols.join()}) values (${v.vals.join()});`;
  v.r = alasql(v.sql); if( v.r instanceof Error ) throw v.r;
}

/*[
  'select * from node where nId=39',
  'select -nId as x from node where pId=39',
  'select * from node where nId in (36,38)',
  'select * from node where 30 < nId and nId < 40 and nId not in (36,38)',
]//.forEach(sql => console.log(JSON.stringify(alasql(sql))));*/

[
  {sql:'insert into node select * from ?',param:[{nId:107}]},
  {sql:'select * from node where nId > 106'},
].forEach(o => {
  v.r = o.param ? alasql(o.sql,[o.param]) : alasql(o.sql);
  console.log(JSON.stringify(v.r))
});
//v.sql = 'select * from node where nId > 106';
//console.log(JSON.stringify(alasql(v.sql)));
</script>
</html>